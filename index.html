<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Infestation</title>
<link rel="stylesheet" href="css/style.css">
</head>
<body>

<!-- ==================== START SCREEN ==================== -->
<section id="startScreen" class="screen active">
  <pre id="ascii-title">
░▒▓█▓▒░▒▓███████▓▒░░▒▓████████▓▒░▒▓████████▓▒░░▒▓███████▓▒░▒▓████████▓▒░▒▓██████▓▒░▒▓████████▓▒░▒▓█▓▒░░▒▓██████▓▒░░▒▓███████▓▒░
░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░      ░▒▓█▓▒░      ░▒▓█▓▒░         ░▒▓█▓▒░  ░▒▓█▓▒░░▒▓█▓▒░ ░▒▓█▓▒░   ░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░
░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░      ░▒▓█▓▒░      ░▒▓█▓▒░         ░▒▓█▓▒░  ░▒▓█▓▒░░▒▓█▓▒░ ░▒▓█▓▒░   ░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░
░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓██████▓▒░ ░▒▓██████▓▒░  ░▒▓██████▓▒░   ░▒▓█▓▒░  ░▒▓████████▓▒░ ░▒▓█▓▒░   ░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░
░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░      ░▒▓█▓▒░             ░▒▓█▓▒░  ░▒▓█▓▒░  ░▒▓█▓▒░░▒▓█▓▒░ ░▒▓█▓▒░   ░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░
░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░      ░▒▓█▓▒░             ░▒▓█▓▒░  ░▒▓█▓▒░  ░▒▓█▓▒░░▒▓█▓▒░ ░▒▓█▓▒░   ░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░
░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░      ░▒▓████████▓▒░▒▓███████▓▒░   ░▒▓█▓▒░  ░▒▓█▓▒░░▒▓█▓▒░ ░▒▓█▓▒░   ░▒▓█▓▒░░▒▓██████▓▒░░▒▓█▓▒░░▒▓█▓▒░
  </pre>
  <p>
    Maya has been unlucky enough to become host to a worm‑like alien parasite.
    Manage her physical and mental state while she tries to uncover the truth.
  </p>
  <div id="start-buttons-container" style="display: flex; gap: 1rem;">
      <button id="startBtn">Begin</button>
      <button id="loadBtn">Load Game</button>
  </div>
  <button id="quickStartBtn" class="overlayBtn">Quick Start (Debug)</button>
</section>

<!-- ==================== LOAD OVERLAY (from Start Screen) ==================== -->
<div id="loadBtn-overlay" class="overlay">
  <div class="overlayHeader">Load Game</div>
  <div class="overlayClose" onclick="closeAllOverlays()">✖</div>
  <div class="overlayBody"></div>
</div>

<!-- ==================== CHARACTER CREATION SCREEN ==================== -->
<section id="creationScreen" class="screen">
  <div class="creation-container">
    <div class="creation-header">
      <h2>Create Your Character</h2>
    </div>
    <div class="creation-main">
      <!-- Column 1: Height, Hair Length, Eye Color -->
      <div class="creation-column">
        <div class="option-group">
          <label for="heightSlider">Height: <span id="heightValue">170</span> cm</label>
          <input type="range" id="heightSlider" min="150" max="185" value="170">
        </div>
        <div class="option-group">
          <label for="hairLengthSlider">Hair Length: <span id="hairLengthValue">10</span> cm</label>
          <input type="range" id="hairLengthSlider" min="0" max="100" value="10">
        </div>
        <div class="option-group push-to-bottom">
            <label>Eye Color:</label>
            <div id="eye-color-picker" class="hex-picker-container"></div>
        </div>
      </div>

      <!-- Column 2: Skin Color, Hair Color -->
      <div class="creation-column">
        <div class="option-group">
            <label>Skin Color:</label>
            <div id="skin-color-picker" class="hex-picker-container"></div>
        </div>
        <div class="option-group">
            <label style="display: flex; align-items: center; gap: 0.5rem; justify-content: center;">
                <input type="checkbox" id="unnaturalColorsToggle">
                Show Unnatural Colors
            </label>
        </div>
        <div class="option-group push-to-bottom">
            <label>Hair Color:</label>
            <div id="hair-color-picker" class="hex-picker-container"></div>
        </div>
      </div>

      <!-- Column 3: Body Descriptors -->
      <div class="creation-column">
        <div class="option-group">
            <label>Body Shape:</label>
            <div id="bodyShapeOptions" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;"></div>
        </div>
      </div>

      <!-- Column 4: Preview -->
      <div id="creation-preview" class="creation-column">
        <!-- Character preview will be generated by JS here -->
      </div>
    </div>
    <div class="creation-footer">
        <button id="finalizeBtn" class="overlayBtn">Finalize Character</button>
    </div>
  </div>
</section>

<!-- ==================== MAIN GAME SCREEN ==================== -->
<section id="gameScreen" class="screen">
  <!-- ---------- Sidebar (always visible) ---------- -->
  <aside id="sidebar">
    <h3>Game Info</h3>

    <!-- Header row: Time | Money -->
    <div id="headerRow">
      <span id="clock">09:00</span>
      <span id="money">$0.00</span>
    </div>

    <!-- Date row -->
    <div id="dateRow" style="text-align: center; margin-bottom: 1rem;">
        <span id="date"></span>
    </div>

    <!-- Character description -->
    <div id="charDesc">Wearing: lab coat, sneakers</div>

<!-- ==================== NEED CONTAINERS (NEW LAYOUT) ==================== -->

<!-- regular needs -->
<div class="need" id="need-tiredness"
     data-name="Fatigue"
     data-labels="Exhausted|Very Tired|Tired|Alert|Energized"
     data-label-ranges="10,30,60,90,100">
  <div class="needHeader">
    <span class="needLine"><!-- filled by JS --> </span>
  </div>
  <div class="bar"><span class="fill"></span></div>
  <div class="tooltip"></div>
</div>

<div class="need" id="need-stress"
     data-name="Stress"
     data-labels="Relaxed|Calm|Stressed|Very Stressed|Panicked"
     data-label-ranges="10,40,70,90,100">
  <div class="needHeader">
    <span class="needLine"></span>
  </div>
  <div class="bar"><span class="fill"></span></div>
  <div class="tooltip"></div>
</div>

<div class="need" id="need-trauma"
     data-name="Trauma"
     data-labels="Secure|Stable|Traumatized|Severely Traumatized|Shattered"
     data-label-ranges="10,30,60,90,100">
  <div class="needHeader">
    <span class="needLine"></span>
  </div>
  <div class="bar"><span class="fill"></span></div>
  <div class="tooltip"></div>
</div>

<div class="need" id="need-happiness"
     data-name="Happiness"
     data-labels="Depressed|Very Unhappy|Unhappy|Content|Joyful"
     data-label-ranges="10,30,70,90,100">
  <div class="needHeader">
    <span class="needLine"></span>
  </div>
  <div class="bar"><span class="fill"></span></div>
  <div class="tooltip"></div>
</div>

<div class="need" id="need-arousal"
     data-name="Arousal"
     data-labels="Numb|Very Low|Low|Normal|High"
     data-label-ranges="5,20,50,80,100">
  <div class="needHeader">
    <span class="needLine"></span>
  </div>
  <div class="bar"><span class="fill"></span></div>
  <div class="tooltip"></div>
</div>

<!-- hidden / “bad” needs – keep hidden until shown -->
<div class="need hiddenBar noName" id="need-corruption"
     data-name="Corruption"
     data-labels="None|Trace|Low|Medium|High"
     data-label-ranges="1,20,50,80,100">
  <div class="needHeader"><span class="needLine"></span></div>
  <div class="bar"><span class="fill"></span></div>
  <div class="tooltip"></div>
</div>

<div class="need hiddenBar noName" id="need-alcohol"
     data-name="Alcohol"
     data-labels="Sober|Buzzed|Tipsy|Drunk|Wasted"
     data-label-ranges="1,20,50,80,100">
  <div class="needHeader"><span class="needLine"></span></div>
  <div class="bar"><span class="fill"></span></div>
  <div class="tooltip"></div>
</div>

<div class="need hiddenBar noName" id="need-drugs"
     data-name="Drugs"
     data-labels="Clean|Mild|Moderate|Heavy|Overdose"
     data-label-ranges="1,20,50,80,100">
  <div class="needHeader"><span class="needLine"></span></div>
  <div class="bar"><span class="fill"></span></div>
  <div class="tooltip"></div>
</div>

    <!-- Bottom button bar (static HTML – JS will attach handlers) -->
    <div id="bottomButtons">
      <button id="btnChar"    class="bottomBtn">Character</button>
      <button id="btnSocial"  class="bottomBtn">Social</button>
      <button id="btnJournal" class="bottomBtn">Journal</button>
      <button id="btnSaves"   class="bottomBtn">Saves</button>

      <!-- Settings button – always visible -->
      <button id="btnSettings" class="bottomBtn settingsBtn">Settings</button>

      <!-- Cheats button – hidden until checkbox is ticked -->
      <button id="cheatsBtn"   class="bottomBtn cheatsBtn" style="display:none;">Cheats</button>
    </div>
  </aside>
<!-- CHARACTER overlay -->
<div id="btnChar-overlay" class="overlay">
  <div class="overlayHeader">Character</div>
  <div class="overlayClose" onclick="closeAllOverlays()">✖</div>
  <div class="overlayBody">
    <div id="char-buttons" style="display: flex; justify-content: space-between; gap: 0.5rem;">
        <button class="overlayBtn" style="flex-grow: 1;" onclick="showCharTab('status')">Status</button>
        <button class="overlayBtn" style="flex-grow: 1;" onclick="showCharTab('skills')">Skills</button>
        <button class="overlayBtn" style="flex-grow: 1;" onclick="showCharTab('equipment')">Equipment</button>
        <button class="overlayBtn" style="flex-grow: 1;" onclick="showCharTab('inventory')">Inventory</button>
        <button class="overlayBtn" style="flex-grow: 1;" onclick="showCharTab('stats')">Stats</button>
    </div>
    <div id="char-tab-content-wrapper" style="overflow-y: auto; min-height: 0;">
        <div id="char-status" class="char-tab"></div>
        <div id="char-skills" class="char-tab" style="display: none;"></div>
        <div id="char-stats" class="char-tab" style="display: none;"></div>
        <div id="char-equipment" class="char-tab" style="display: none;"></div>
        <div id="char-inventory" class="char-tab" style="display: none;"></div>
    </div>
  </div>
</div>


<!-- SOCIAL overlay -->
<div id="btnSocial-overlay" class="overlay">
  <div class="overlayHeader">Social</div>
  <div class="overlayClose" onclick="closeAllOverlays()">✖</div>
  <div class="overlayBody"></div>
</div>

<!-- JOURNAL overlay -->
<div id="btnJournal-overlay" class="overlay">
  <div class="overlayHeader">Journal</div>
  <div class="overlayClose" onclick="closeAllOverlays()">✖</div>
  <div class="overlayBody"></div>
</div>

<!-- SAVES overlay -->
<div id="btnSaves-overlay" class="overlay">
  <div class="overlayHeader">Saves</div>
  <div class="overlayClose" onclick="closeAllOverlays()">✖</div>
  <div class="overlayBody"></div>
</div>
  <!-- ---------- Main area (events / rooms) ---------- -->
  <main id="mainArea">
    <!-- Content will be injected by JavaScript -->
  </main>
</section>

<!-- SETTINGS overlay (square, 30 % of viewport width) -->
<div id="btnSettings-overlay" class="overlay settingsOverlay">
  <div class="overlayHeader">Settings</div>
  <div class="overlayClose" onclick="closeAllOverlays()">✖</div>
  <div class="overlayBody">
    <label style="display:flex;align-items:center;gap:.4rem;">
      <input type="checkbox" id="cheatsChk" onchange="toggleCheats(this)">
      Enable Cheats
    </label>
    <hr style="margin: 1rem 0;">
    <div style="margin-bottom: 1rem;">
      <strong>Font Family</strong>
      <div id="font-options" style="display: flex; flex-direction: column; gap: 0.5rem; margin-top: 0.5rem;">
        <label><input type="radio" name="font" value="Arial, Helvetica, sans-serif" onchange="changeFont(this.value)"> Arial</label>
        <label><input type="radio" name="font" value="'Times New Roman', Times, serif" onchange="changeFont(this.value)"> Times New Roman</label>
        <label><input type="radio" name="font" value="'Courier New', Courier, monospace" onchange="changeFont(this.value)"> Courier New</label>
        <label><input type="radio" name="font" value="Verdana, Geneva, sans-serif" onchange="changeFont(this.value)"> Verdana</label>
      </div>
    </div>
    <div>
      <strong>Font Size</strong>
      <div id="fontsize-options" style="display: flex; flex-direction: column; gap: 0.5rem; margin-top: 0.5rem;">
        <label><input type="radio" name="fontsize" value="0.9rem" onchange="changeFontSize(this.value)"> Small</label>
        <label><input type="radio" name="fontsize" value="1rem" onchange="changeFontSize(this.value)"> Medium</label>
        <label><input type="radio" name="fontsize" value="1.2rem" onchange="changeFontSize(this.value)"> Large</label>
      </div>
    </div>
  </div>
</div>

<!-- ==================== CALENDAR OVERLAY ==================== -->
<div id="calendar-overlay" class="overlay" style="display: none;">
  <div class="overlayHeader" id="calendar-header" style="display: flex; justify-content: space-between; align-items: center;">
    <button id="calendar-prev-btn" class="overlayBtn">&lt;</button>
    <span id="calendar-month-year"></span>
    <button id="calendar-next-btn" class="overlayBtn">&gt;</button>
  </div>
  <div class="overlayBody" id="calendar-body">
    <div id="calendar-weekdays" style="display: grid; grid-template-columns: repeat(7, 1fr); text-align: center; margin-bottom: 0.5rem; font-size: 0.8em; color: #aaa;">
      <div>Sun</div>
      <div>Mon</div>
      <div>Tue</div>
      <div>Wed</div>
      <div>Thu</div>
      <div>Fri</div>
      <div>Sat</div>
    </div>
    <div id="calendar-days" style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 2px;">
      <!-- Day cells will be inserted by JS -->
    </div>
  </div>
</div>

<!-- CHEATS overlay (same square size) -->
<div id="cheatsBtn-overlay" class="overlay cheatsOverlay">
  <div class="overlayHeader">Cheats</div>
  <div class="overlayClose" onclick="closeAllOverlays()">✖</div>
  <div class="overlayBody">
    <!-- Cheat controls will be inserted by JS later -->
  </div>
</div>

<!-- ==================== SUB-OVERLAY for item selection etc. ==================== -->
<div id="sub-overlay" class="tooltip-overlay">
  <div class="overlayHeader"></div>
  <div class="overlayClose" onclick="document.getElementById('sub-overlay').style.display='none'">✖</div>
  <div class="overlayBody"></div>
</div>

<!-- ==================== TAILOR HUB OVERLAY ==================== -->
<div id="tailor-hub-overlay" class="overlay">
  <div class="overlayHeader">The Tailor</div>
  <div class="overlayClose" onclick="closeAllOverlays()">✖</div>
  <div class="overlayBody">
    <p>Welcome to the Tailor. What kind of clothing would you like to create?</p>
    <div id="tailor-slot-buttons" style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 1rem;">
      <!-- Slot buttons will be dynamically inserted here -->
    </div>
  </div>
</div>

<!-- ==================== TAILOR CRAFTING OVERLAY ==================== -->
<div id="tailor-crafting-overlay" class="overlay">
  <div class="overlayHeader">Crafting Menu</div>
  <div class="overlayClose" onclick="closeAllOverlays()">✖</div>
  <div class="overlayBody" style="display: flex; flex-direction: column; height: calc(100% - 2.2rem); gap: 1rem;">

    <!-- Top Row: Template and Name -->
    <div style="display: flex; gap: 2rem; align-items: center;">
        <div style="flex-basis: 50%;">
            <label for="tailor-template-select">Template:</label>
            <select id="tailor-template-select" onchange="onTemplateSelect()" style="width: 100%;">
                <option value="">--Please choose a template--</option>
            </select>
        </div>
        <div style="flex-basis: 50%;">
            <label for="tailor-item-name">Item Name:</label>
            <input type="text" id="tailor-item-name" disabled style="width: 100%;">
        </div>
    </div>

    <!-- Main Content Area: 3 Columns -->
    <div style="display: flex; flex: 1; gap: 1rem; overflow: hidden;">

      <!-- Column 1: Available Tags (Now Categorized) -->
      <div id="tailor-tags-sections-wrapper" style="flex: 1; display: none; flex-direction: column; min-height: 0;">

        <!-- Materials Dropdown -->
        <div id="tailor-material-section" style="margin-bottom: 1rem;">
            <strong>Material:</strong>
            <select id="tailor-material-select" style="width: 100%; margin-top: 0.25rem;">
                <!-- Material options will be dynamically inserted here -->
            </select>
        </div>

        <!-- Style Tags -->
        <div id="tailor-style-section" style="margin-bottom: 1rem; display: flex; flex-direction: column; min-height: 0;">
            <strong>Style Tags:</strong>
            <div id="tailor-style-tags-container" style="flex: 1; overflow-y: auto; border: 1px solid #444; padding: 0.5rem; display: flex; flex-direction: column; gap: 0.5rem; margin-top: 0.25rem;">
              <!-- Style tag checkboxes will be dynamically inserted here -->
            </div>
        </div>

        <!-- General Tags -->
        <div id="tailor-general-section" style="display: flex; flex-direction: column; min-height: 0; flex: 1;">
            <strong>General Tags:</strong>
            <div id="tailor-general-tags-container" style="flex: 1; overflow-y: auto; border: 1px solid #444; padding: 0.5rem; display: flex; flex-direction: column; gap: 0.5rem; margin-top: 0.25rem;">
              <!-- General tag checkboxes will be dynamically inserted here -->
            </div>
        </div>

      </div>

      <!-- Column 2: Covers -->
      <div style="flex: 1; display: flex; flex-direction: column; min-height: 0;">
        <strong>Covers:</strong>
        <ul id="tailor-coverage-list" style="flex: 1; overflow-y: auto; border: 1px solid #444; padding: 0.5rem; list-style-position: inside; margin-top: 0.5rem; margin-left:0; padding-left: 1.2rem;">
          <!-- Coverage list will be dynamically inserted here -->
        </ul>
      </div>

      <!-- Column 3: Final Tags -->
      <div style="flex: 1; display: flex; flex-direction: column; min-height: 0;">
        <strong>Final Tags:</strong>
        <ul id="tailor-final-tags-list" style="flex: 1; overflow-y: auto; border: 1px solid #444; padding: 0.5rem; list-style-position: inside; margin-top: 0.5rem; margin-left:0; padding-left: 1.2rem;">
            <!-- Final tags will be dynamically inserted here -->
        </ul>
      </div>
    </div>

    <!-- Bottom Button Bar -->
    <div style="padding-top: 1rem; border-top: 1px solid #444; text-align: right;">
        <button id="craft-item-btn" class="overlayBtn" onclick="craftItemFromMenu()">Craft Item</button>
        <button class="overlayBtn" onclick="backToTailorHub()">Back to Slots</button>
    </div>
  </div>
</div>

<!-- ==================== BODY ART STUDIO OVERLAY ==================== -->
<div id="body-art-studio-overlay" class="overlay">
    <div class="overlayHeader">Body Art Studio</div>
    <div class="overlayClose" onclick="closeAllOverlays()">✖</div>
    <div class="overlayBody" style="display: flex; flex-direction: column; gap: 1rem;">
        <!-- Tabs -->
        <div id="body-art-tabs" style="display: flex; border-bottom: 1px solid #444; padding-bottom: 0.5rem; gap: 0.5rem;">
            <button class="overlayBtn" style="flex-grow: 1;" onclick="showBodyArtTab('tattoos')">Tattoos</button>
            <button class="overlayBtn" style="flex-grow: 1;" onclick="showBodyArtTab('piercings')">Piercings</button>
        </div>

        <!-- Tattoo Tab (New Refactored Layout) -->
        <div id="body-art-tab-tattoos" class="body-art-tab" style="display: none; flex-grow: 1; min-height: 0; display: flex; flex-direction: column; gap: 1rem;">
            <!-- Top Row: Selections -->
            <div style="display: flex; gap: 1rem; align-items: center;">
                <div style="flex-basis: 33%;">
                    <label for="tattoo-body-part-select">Body Part:</label>
                    <select id="tattoo-body-part-select" style="width: 100%;" onchange="onTattooPartSelect()"></select>
                </div>
                <div style="flex-basis: 33%;">
                    <label>Design:</label>
                    <p id="tattoo-template-name" style="font-weight: bold; margin: 0;"></p>
                </div>
                <div style="flex-basis: 33%;">
                    <label for="tattoo-name-input">Tattoo Name:</label>
                    <input type="text" id="tattoo-name-input" style="width: 100%;">
                </div>
            </div>

            <!-- Main Content Area: 3 Columns -->
            <div style="display: flex; flex: 1; gap: 1rem; overflow: hidden; min-height: 0;">
                <!-- Column 1: Customization Tags -->
                <div id="tattoo-tags-sections-wrapper" style="flex: 1; display: none; flex-direction: column; gap: 1rem;">
                    <!-- Style Tags, Feature Tags, Size Tags -->
                    <div id="tattoo-style-section">
                        <strong>Style:</strong>
                        <div id="tattoo-style-tags-container" style="border: 1px solid #444; padding: 0.5rem; display: flex; flex-direction: column; gap: 0.5rem; margin-top: 0.25rem;"></div>
                    </div>
                    <div id="tattoo-feature-section">
                        <strong>Features:</strong>
                        <div id="tattoo-feature-tags-container" style="border: 1px solid #444; padding: 0.5rem; display: flex; flex-direction: column; gap: 0.5rem; margin-top: 0.25rem;"></div>
                    </div>
                    <div id="tattoo-size-section">
                        <strong>Size:</strong>
                        <div id="tattoo-size-tags-container" style="border: 1px solid #444; padding: 0.5rem; display: flex; flex-direction: column; gap: 0.5rem; margin-top: 0.25rem;"></div>
                    </div>
                    <div id="tattoo-theme-section">
                        <strong>Theme:</strong>
                        <div id="tattoo-theme-tags-container" style="border: 1px solid #444; padding: 0.5rem; display: flex; flex-direction: column; gap: 0.5rem; margin-top: 0.25rem;"></div>
                    </div>
                </div>

                <!-- Column 2: Preview & Removal -->
                <div style="flex: 1; display: flex; flex-direction: column; min-height: 0; gap: 1rem;">
                    <div style="flex-basis: 50%; display: flex; flex-direction: column;">
                        <strong>Preview & Customization:</strong>
                        <div id="tattoo-preview-container" style="flex: 1; border: 1px solid #444; padding: 0.5rem; margin-top: 0.5rem; background: #111;">
                            <p><strong>Description:</strong> <span id="tattoo-preview-design"></span></p>
                            <div id="tattoo-text-section" style="display: none; margin-top: 0.5rem;">
                                <strong>Custom Text:</strong>
                                <input type="text" id="tattoo-custom-text" style="width: 100%; margin-top: 0.25rem;" oninput="updateTattooPreview()">
                            </div>
                        </div>
                    </div>
                    <div style="flex-basis: 50%; display: flex; flex-direction: column;">
                        <h4>Remove a Tattoo (Cost: $5000)</h4>
                        <div id="current-tattoos-container" style="flex-grow: 1; overflow-y: auto; border: 1px solid #444; padding: 0.5rem; margin-top: 0.5rem;"></div>
                    </div>
                </div>

                <!-- Column 3: Final Tags & Cost -->
                <div style="flex: 1; display: flex; flex-direction: column; min-height: 0;">
                    <strong>Final Tags:</strong>
                    <ul id="tattoo-final-tags-list" style="flex: 1; overflow-y: auto; border: 1px solid #444; padding: 0.5rem; list-style-position: inside; margin-top: 0.5rem; margin-left:0; padding-left: 1.2rem;"></ul>
                </div>
            </div>

            <!-- Bottom Button Bar -->
            <div style="padding-top: 1rem; border-top: 1px solid #444; text-align: right;">
                <button id="get-tattoo-btn" class="overlayBtn" onclick="getTattoo()">Get Tattoo</button>
            </div>
        </div>

        <!-- Piercing Tab (New Crafting Layout) -->
        <div id="body-art-tab-piercings" class="body-art-tab" style="display: none; flex-grow: 1; min-height: 0; display: flex; flex-direction: column; gap: 1rem;">
            <!-- Top Row: Selections -->
            <div style="display: flex; gap: 2rem; align-items: center; margin-bottom: 1rem;">
                <div style="flex-basis: 50%;">
                    <label for="piercing-location-select">Location:</label>
                    <select id="piercing-location-select" style="width: 100%;" onchange="updatePiercingPreview()"></select>
                </div>
                <div style="flex-basis: 50%;">
                    <label for="piercing-material-select">Material:</label>
                    <select id="piercing-material-select" style="width: 100%;" onchange="updatePiercingPreview()"></select>
                </div>
                <div style="flex-basis: 50%;">
                    <label for="piercing-style-select">Style:</label>
                    <select id="piercing-style-select" style="width: 100%;" onchange="updatePiercingPreview()"></select>
                </div>
            </div>

            <!-- Preview & Cost -->
            <div style="border: 1px solid #444; padding: 0.5rem; background: #111;">
                <p><strong>Jewelry:</strong> <span id="piercing-preview-jewelry"></span></p>
                <p><strong>Final Name:</strong> <span id="piercing-preview-name"></span></p>
            </div>

            <!-- Bottom Button Bar -->
            <div style="padding-top: 1rem; border-top: 1px solid #444; text-align: right; margin-top: auto;">
                <button id="get-piercing-btn" class="overlayBtn" onclick="getPiercing()">Get Piercing</button>
            </div>
        </div>
    </div>
</div>

<!-- ==================== MANAGE PIERCINGS OVERLAY ==================== -->
<div id="manage-piercings-overlay" class="overlay">
    <div class="overlayHeader">Manage Piercings</div>
    <div class="overlayClose" onclick="closeAllOverlays()">✖</div>
    <div class="overlayBody" style="display: flex; gap: 1rem; min-height: 0;">
        <!-- Left Column: Equipped -->
        <div style="flex: 1; display: flex; flex-direction: column;">
            <h4>Equipped</h4>
            <div id="equipped-piercings-list" style="flex-grow: 1; overflow-y: auto; border: 1px solid #444; padding: 0.5rem;"></div>
        </div>
        <!-- Right Column: Stored -->
        <div style="flex: 1; display: flex; flex-direction: column;">
            <h4>Stored</h4>
            <div id="stored-piercings-list" style="flex-grow: 1; overflow-y: auto; border: 1px solid #444; padding: 0.5rem;"></div>
        </div>
    </div>
</div>

<!-- ==================== NOTIFICATION OVERLAY ==================== -->
<div id="craft-notification-overlay"></div>
<div id="error-notification-overlay"></div>

<!-- ==================== GRAYSCALE OVERLAY ==================== -->
<div id="grayscale-overlay" class="overlay" style="width: 15rem; height: auto; min-height: 0;">
  <div id="grayscale-picker-container" class="overlayBody hex-picker-container" style="margin-top: 0;">
      <!-- Grayscale hexes will be populated by JS -->
  </div>
</div>

<!-- ==================== SAVE PROMPT OVERLAY ==================== -->
<div id="save-prompt-overlay" class="overlay" style="width: 25vw; height: auto; min-height: 0;">
  <div class="overlayHeader">Enter Save Name</div>
  <div class="overlayBody">
    <input type="text" id="save-name-input" style="width: 100%; margin-bottom: 1rem; padding: 0.4rem;">
    <div style="display: flex; justify-content: flex-end; gap: 0.5rem;">
      <button id="save-cancel-btn" class="overlayBtn">Cancel</button>
      <button id="save-confirm-btn" class="overlayBtn">Save</button>
    </div>
  </div>
</div>

<!-- ==================== SCRIPTS ==================== -->
<!-- Data -->
<script src="js/data/clothingTemplates.js"></script>
<script src="js/data/bodyArtTemplates.js"></script>
<script src="js/data/bodyPartDescriptors.js"></script>
<script src="js/data/colorPalettes.js"></script>
<script src="js/data/scenes.js"></script>
<script src="js/data/sexActions.js"></script>
<script src="js/data/tags.js"></script>

<!-- Systems -->
<script src="js/systems/classes.js"></script>
<script src="js/systems/state.js"></script>
<script src="js/systems/utils.js"></script>
<script src="js/systems/ui.js"></script>
<script src="js/systems/game.js"></script>
<script src="js/systems/saveLoad.js"></script>
<script src="js/systems/reproductive.js"></script>
<script src="js/systems/clothing.js"></script>
<script src="js/systems/factories.js"></script>

<!-- Features -->
<script src="js/features/characterCreation.js"></script>
<script src="js/features/characterSheet.js"></script>
<script src="js/features/crafting.js"></script>
<script src="js/features/bodyArt.js"></script>
<script src="js/features/sexScenes.js"></script>
<script src="js/features/journal.js"></script>
<script src="js/features/social.js"></script>
<script src="js/features/cheats.js"></script>

<!-- Main -->
<script src="js/main.js"></script>

</body>
</html>
